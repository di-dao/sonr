version: "3"

tasks:
  sonrd:
    desc: "Builds the project for current platform"
    cmds:
      - go build -o /deploy/sonrd ./cmd/sonrd
      - docker build -t sonrhq/sonrd:latest -f ./deploy/Dockerfile.node ./deploy

  hway:
    desc: "Builds the project for current platform"
    cmds:
      - go build -o /deploy/hway ./cmd/hway
      - docker build -t sonrhq/hway:latest -f ./deploy/Dockerfile.hway ./deploy

  compose-up:
    cmds:
      - task: compose-down
      - docker compose -f ./deploy/testnet/docker-compose.local.yml up --abort-on-container-exit

  compose-down:
    ignore_error: true
    cmds:
      - docker compose -f ./deploy/testnet/docker-compose.local.yml down
