syntax = "proto3";

// Package Motor is used for defining a Motor node and its properties.
package sonrhq.highway.vault.v1;
import "common/v1/data.proto";
import "gogoproto/gogo.proto";
import "google/api/annotations.proto";
option go_package = "github.com/sonr-hq/sonr/core/highway/types/v1/vault";

// KeygenRequest is the request to generate a new keypair.
message KeygenRequest {
    string prefix = 1;
    int32 threshold = 2;
    
}

// KeygenResponse is the response to a Keygen request.
message KeygenResponse {
    bytes id = 1;
    string address = 2;
    common.v1.WalletShareConfig share_config = 3;
    string vault_cid = 4;
}

// RefreshRequest is the request to refresh the keypair.
message RefreshRequest {
    repeated common.v1.WalletShareConfig share_configs = 1;
}

// RefreshResponse is the response to a Refresh request.
message RefreshResponse {
    bytes id = 1;
    repeated common.v1.WalletShareConfig share_configs = 2;
}

// SignRequest is the request to sign data with the private key.
message SignRequest {
    bytes id = 1;
    bytes data = 2;
    repeated common.v1.WalletShareConfig share_configs = 3;
}

// SignResponse is the response to a Sign request.
message SignResponse {
    bytes id = 1;
    bytes signature = 2;
    bytes data = 3;
    repeated common.v1.WalletShareConfig share_configs = 4;
}

// DeriveRequest is the request to derive a new key from the private key.
message DeriveRequest {
    bytes id = 1;
    uint64 index = 2;
    repeated common.v1.WalletShareConfig share_configs = 3;
}

// DeriveResponse is the response to a Derive request.
message DeriveResponse {
    bytes id = 1;
    string address = 2;
    repeated common.v1.WalletShareConfig share_configs = 3;
}

// Vault is the service used for managing a node's keypair.
service Vault {
    // Keygen generates a new keypair and returns the public key.
    rpc Keygen(KeygenRequest) returns (KeygenResponse) {
        option (google.api.http).post = "/sonr-io/highway/vault/keygen";
    }

    // Refresh refreshes the keypair and returns the public key.
    rpc Refresh(RefreshRequest) returns (RefreshResponse) {
        option (google.api.http).post = "/sonr-io/highway/vault/refresh";
    }

    // Sign signs the data with the private key and returns the signature.
    rpc Sign(SignRequest) returns (SignResponse) {
        option (google.api.http).post = "/sonr-io/highway/vault/sign";
    }

    // Derive derives a new key from the private key and returns the public key.
    rpc Derive(DeriveRequest) returns (DeriveResponse) {
        option (google.api.http).post = "/sonr-io/highway/vault/derive";
    }
}
