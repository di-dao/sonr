version: '3'

tasks:
  testnet:
    dir: ./deploy/networks/testnet-1
    cmds:
      - task: build
      - docker stack deploy -c ./docker-compose.yml --prune testnet-1

  local-gateway:
    cmd: air -c ./deploy/networks/local/air-gateway.toml

  local-node:
    cmd: air -c ./deploy/networks/local/air-node.toml

  # build:
  #   cmd: earthly --push --sat=builder +build
  #   internal: true

  # ipfs:
  #   dir: ./deploy/rails/kubo
  #   cmds:
  #     - task: build
  #     - docker stack deploy -c ./docker-compose.yml --prune ipfs

  # faucet:
  #   dir: ./deploy/rails/faucet
  #   cmds:
  #     - task: build
  #     - docker stack deploy -c ./docker-compose.yml --prune faucet

  # matrix:
  #   dir: ./deploy/rails/dendrite
  #   cmds:
  #     - task: build
  #     - docker stack deploy -c ./docker-compose.yml --prune matrix
