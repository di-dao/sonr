Similar to Amazon S3 or DigitalOcean Spaces, developers can leverage our decentralized storage module for uploading either application specific assets or user specific assets.
The Sonr bucket module is used to record the defined collections of Objects utilized by an Application on the Sonr Network. A bucket can be either public access, private access, or restricted access based on Developer configuration. A bucket is used to help organize similar objects for a given application. Much like folders on a file system, buckets can be nested in order to create a deeply nested structure of content.

## Overview

A Bucket is represented by a document on chain called a `WhereIs`. This document is referenced by its `Creator` and `DID` which provided a unique identifier to the content store. Buckets reference content by `BucketItems` which hold content identifiers. These identifiers can point to either `did` Content stores can reference one another, which allow data so be sub-categorized and referenced by many buckets.

### WhereIs definition

As stated within the `overview`, a `WhereIs` document is the on chain reference to a Bucket. Which hold it's `DID`, `Creator` and `BucketItems`.
Sure, here's how the given content can be refactored:

```json
{
  "did": "<string>",        // DID of the created bucket.
  "creator": "<string>",    // Creator of the new bucket
  "label": "<string>",      // Label of the new bucket.
  "visibility": "<enum>",   // Visibility of the new bucket.
  "role": "<enum>",         // Role of the creator of the new bucket.
  "is_active": "<boolean>", // IsActive flag of the new bucket.
  "content": "<array>",     // Content of the new bucket map of DIDs to CIDs.
  "timestamp": "<integer>"  // Timestamp of the new bucket.
}
```

### Bucket Items

A `BucketItem` is a JSON object that refers to either a Document, or another bucket itself.

```json
{
  "name": "<string>",       // Name of the bucket item.
  "uri": "<string>",        // DID of the item. If applicable // optional
  "timestamp": "<integer>", // Timestamp of the last update. // optional
  "type": "<enum>",         // Type of the resource
  "schema_did": "<string>"  // References the schema and item within the bucket is associated with. Bucket items do not need to use the same schema reference // optional
}
```

#### Example Bucket Output:

```json
{
  "name": "jock-#1",
  "uri": "afyreihfrzall55r76lxzxt373lu7nz5mcaq7bawqlh3kdewlyvo4ebvoq",
  "timestamp": 1661895712,
  "type": 2,
  "schema_did": "did:snr:2685375f-5652-48a4-b50f-f8aa098be3f5"
}
```

## Accessing Bucket Content

When querying a bucket item which is an object, the following will be returned in a familiar form based on the given platform / motor-sdk version:

```json
{
  "item": "<bytes>",   // Raw content serialized to bytes
  "id": "<string>",    // Content id a CID, DID, or unspecified
  "content_type": "<enum>" // sonrhq.sonr.bucket.ResourceIdentifier
}
```

Where `item` is a `Base64` encoded string of the `Document` queried for. When content is resolved it should be decoded before attempting to convert it to JSON.

### Querying by schema

if a `BucketItem` contains an optional field `Schema Did` then it will support being queried by a given schema.

**Note** At this time the relationship of schema to a Document is not strictly enforced. Objects should only be associated with the schema they are created with.

### Bucket Types

| Type              | Description                                                                                                     |
| ----------------- | --------------------------------------------------------------------------------------------------------------- |
| **App-Specific**  | Created by the developer, will be associated to an application and allowed for usage by the application domain. |
| **User-Specific** | Created with the intent of storing user related content. `WhichIs` then related to the `Creator`.               |

## Usage

Buckets function as a storage of content which holds a loose relation to one another, buckets function as a wrapper around `Objects` to create relationships amongst them. Developers are recommended to think of buckets as `Categories of data`. It's recommended to make one Bucket per [schema](/docs/intro/modules/schemas.mdx).

- See [Speedway](/docs/tools/speedway/cli.mdx) documentation on usage of buckets through our management tooling.
- See [Motor-SDK](/docs/guides/data/schemas.mdx) documentation in our SDK targets.
- Read [ADR-3](https://github.com/sonrhq/core/blob/dev/docs/architecture/3.md) for a more in depth technical explanation of the design decisions made for the bucket module.
